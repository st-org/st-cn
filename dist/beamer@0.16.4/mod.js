var e={d:(t,n)=>{for(var i in n)e.o(n,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:n[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};e.d(t,{i0:()=>m,vc:()=>r,mH:()=>p,Wi:()=>f,h0:()=>v,Kl:()=>g,$F:()=>d,_8:()=>c,_R:()=>u});const n=["download","href","hreflang","ping","referrerpolicy","rel","target","type"];function i(e){for(const t of e.querySelectorAll("a")){const e=document.createElement("span");for(const{name:i,value:o}of t.attributes)if(!n.includes(i))try{e.setAttribute(i,o)}catch(e){console.log(e)}for(const n of t.childNodes)e.append(n);t.replaceWith(e)}return e}var o=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function s(e){try{d(i.next(e))}catch(e){r(e)}}function l(e){try{d(i.throw(e))}catch(e){r(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,l)}d((i=i.apply(e,t||[])).next())}))};const r={listen:!1,page:!1},s=1920,l=1080;function d(e){return"string"!=typeof e?NaN:e.endsWith("px")?Number(e.slice(0,-2)):e.endsWith("cm")?96*Number(e.slice(0,-2))/2.54:e.endsWith("mm")?96*Number(e.slice(0,-2))/25.4:e.endsWith("in")?96*Number(e.slice(0,-2)):e.endsWith("pc")?16*Number(e.slice(0,-2)):e.endsWith("pt")?4*Number(e.slice(0,-2))/3:NaN}function c(e){if("string"!=typeof e)return{width:s,height:l};if(e.endsWith(" landscape")){const{width:t,height:n}=c(e.slice(0,-10).trim());return{width:n,height:t}}if(e.endsWith(" portrait"))return c(e.slice(0,-9).trim());if("A5"===e)return{width:d("148mm"),height:d("210mm")};if("A4"===e)return{width:d("210mm"),height:d("297mm")};if("A3"===e)return{width:d("297mm"),height:d("420mm")};if("B5"===e)return{width:d("176mm"),height:d("250mm")};if("B4"===e)return{width:d("250mm"),height:d("353mm")};if("JIS-B5"===e)return{width:d("182mm"),height:d("257mm")};if("JIS-B4"===e)return{width:d("257mm"),height:d("364mm")};if("letter"===e)return{width:d("8.5in"),height:d("11in")};if("legal"===e)return{width:d("8.5in"),height:d("14in")};if("ledger"===e)return{width:d("11in"),height:d("17in")};const[t,n]=e.trim().split(/\s+/,2).map(d);return isFinite(t)&&t>0?void 0===n?{width:t,height:t}:isFinite(n)&&n>0?{width:t,height:n}:{width:t,height:l}:isFinite(n)&&n>0?{width:s,height:n}:{width:s,height:l}}let a;function h(e){const t=[];for(const n of e.trim().split(/\s+/))if(/^\d+-$/.test(n))t[Number(n.slice(0,-1))-1]=!0;else if(/^\d+$/.test(n)){const e=Number(n);t[e-1]=!0,t[e]=void 0}else if(/^\d+-\d+$/.test(n)){const[e,i]=n.split("-",2).map(Number);for(let n=e-1;n<i;n++)t[n]=!0;t[i]=void 0}else if(/^-\d+$/.test(n)){const e=Number(n.slice(1));for(let n=0;n<e;n++)t[n]=!0;t[e]=void 0}return t}function u(e){const t=[],n=[];for(const[,i,o]of e.matchAll(/((?:\^?-?[_a-zA-Z]+[_a-zA-Z0-9-]*\s+)*)([0-9-][0-9-\s]*)(?:\s+|$)/g))t.push(i),n.push(o);const i=function(e){if(0===e.length)return[];const t=e.map(h),n=Math.max(...t.map((e=>e.length)));if(0===n)return[];for(const e of t)if(e.length<n){const t=e[e.length-1];for(let i=e.length;i<n;i++)e[i]=t}return t}(n);if(0===i.length)return[];const o=i[0].length,r=[];for(let e=0;e<o;e++)r[e]=[];for(let e=0;e<i.length;e++){const n=i[e],o=t[e],s=[],l=[];for(const e of o.trim().split(/\s+/)){if(0===e.length){l.push("invisible");break}e.startsWith("^")?l.push(e.slice(1)):s.push(e)}for(let e=0;e<n.length;e++)n[e]?r[e].push(...s):r[e].push(...l)}return r}function p(e){var t;const n=[];for(const i of e.querySelectorAll("[slide], [data-slide]")){const e=null!==(t=i.getAttribute("slide"))&&void 0!==t?t:i.getAttribute("data-slide");if(null===e)continue;const o=u(e);o.length>0&&n.push({element:i,classesArray:o})}return n}const m=new Map,f=(e,t)=>o(void 0,void 0,void 0,(function*(){let n=m.get(t);var i;void 0===n&&(m.set(t,n={authors:(i=t.context).indexInfoArray.filter((e=>"author"===e.unit.tag)),date:i.indexInfoArray.find((e=>"date"===e.unit.tag)),page:0,size:c(i.extractLastGlobalOption("size","frame")),slides:[]}),function({width:e,height:t},n){if(void 0!==n||!r.page)return;void 0===a&&(a=document.createElement("style"));const i=`@media print {\n    .unit.frame>svg {\n        border: 0;\n        margin: 0;\n    }\n}\n\n@page {\n    margin: 0;\n    size: ${e}px ${t}px;\n}`;a.textContent!==i&&(a.textContent=i),document.head.append(a)}(n.size,t.context.root),function(e,t){if(!r.listen||void 0!==t)return;let n=0;const i=[];let o=-1;function s(t){n===t&&-1!==o||(i[++o]=n=t,i[o+1]=void 0),e[n].scrollIntoView()}let l=!1;addEventListener("keydown",(t=>{if(0!==e.length&&e[0].isConnected)if("Enter"!==t.key){if(l)return"Escape"===t.key?(l=!1,document.documentElement.classList.remove("showing"),void s(n)):"ArrowUp"===t.key||"PageUp"===t.key?(t.preventDefault(),void s((n-1+e.length)%e.length)):"ArrowDown"===t.key||"PageDown"===t.key?(t.preventDefault(),void s((n+1)%e.length)):"ArrowLeft"===t.key?(t.preventDefault(),void function(){let t=i[o-1];void 0!==t&&(n=t,o--,e[n].scrollIntoView())}()):"ArrowRight"===t.key?(t.preventDefault(),void function(){let t=i[o+1];void 0!==t&&(n=t,o++,e[n].scrollIntoView())}()):void 0}else!function(){for(let t=0;t<e.length;t++){const{top:n,height:i}=e[t].getBoundingClientRect();if(n+i/2>=0){document.documentElement.classList.add("showing"),s(t),l=!0;break}}}()})),addEventListener("scroll",(()=>{0!==e.length&&e[0].isConnected&&l&&function(){for(let t=0;t<e.length;t++){const{bottom:n}=e[t].getBoundingClientRect();if(n>1){s(t);break}}}()}))}(n.slides,t.context.root)),n.page++;const o=document.createElement("div");for(let i=0;;i++){const r=document.createElementNS("http://www.w3.org/2000/svg","svg"),s=document.createElementNS("http://www.w3.org/2000/svg","foreignObject"),l=document.createElement("div"),d=document.createElement("main"),c=document.createElement("footer"),a=document.createElement("div"),h=document.createElement("div"),u=document.createElement("div"),m=document.createElement("div");r.setAttribute("viewBox",`0 0 ${n.size.width} ${n.size.height}`),s.setAttribute("width","100%"),s.setAttribute("height","100%"),l.style.height=`${n.size.height}px`,o.append(r),r.append(s),s.append(l),l.append(d),l.append(c),d.append(yield t.compileSTDN(e.children)),c.append(a),c.append(h),c.append(u),c.append(m),n.slides.push(r);for(const{unit:e}of n.authors){const n=document.createElement("span"),{abbr:i}=e.options;"string"==typeof i?n.textContent=i:"object"==typeof i?n.append(yield t.compileUnit(i)):n.append(yield t.compileLine(t.base.stdnToInlinePlainStringLine(e.children))),a.append(n)}if(void 0!==t.context.titleInfo){const{abbr:e}=t.context.titleInfo.unit.options;"string"==typeof e?h.textContent=e:"object"==typeof e?h.append(yield t.compileUnit(e)):h.append(yield t.compileLine(t.base.stdnToInlinePlainStringLine(t.context.titleInfo.unit.children)))}if(void 0!==n.date){const{abbr:e}=n.date.unit.options;"string"==typeof e?u.textContent=e:"object"==typeof e?u.append(yield t.compileUnit(e)):u.append(yield t.compileLine(t.base.stdnToInlinePlainStringLine(n.date.unit.children)))}m.textContent=n.page.toString();let f=!1;const g=d.querySelectorAll(".unit.pause")[i];void 0!==g&&(t.dom.removeAfter(g,d),f=!0);for(const{element:e,classesArray:t}of p(d))i<t.length-1&&(f=!0),e.classList.add(...t[Math.min(i,t.length-1)]);if(!f)break}return o})),g=(e,t)=>o(void 0,void 0,void 0,(function*(){const n=!0===e.options.pause,o=document.createElement("ul");let r,s=0;for(const{id:e,index:l,unit:d}of t.context.headings){if(l.length>2)continue;const c=document.createElement("li"),a=document.createElement("a");c.append(a),a.append(i(yield t.compileLine(t.base.stdnToInlinePlainStringLine(d.children)))),a.href=`#${encodeURIComponent(e)}`,2!==l.length?(r=document.createElement("ul"),o.append(c),c.append(r),s++,n&&s>1&&c.setAttribute("slide",`${s}-`)):void 0!==r&&r.append(c)}return o})),v=(e,t)=>o(void 0,void 0,void 0,(function*(){const n=document.createElement("h1");return n.append(yield t.compileSTDN(e.children)),n}));var w=t.i0,b=t.vc,y=t.mH,x=t.Wi,E=t.h0,A=t.Kl,N=t.$F,S=t._8,L=t._R;export{w as compilerToEnv,b as config,y as extractSlidableElements,x as frame,E as h0,A as outline,N as parseLength,S as parseSize,L as parseSlideStr};